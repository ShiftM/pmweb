var ButtonState=pc.createScript("buttonState");ButtonState.attributes.add("defaultSprite",{type:"asset",assetType:"sprite"}),ButtonState.attributes.add("pressedSprite",{type:"asset",assetType:"sprite"}),ButtonState.attributes.add("target",{type:"entity"}),ButtonState.prototype.initialize=function(){this.pressed=!1,this.propName=this.entity.name.split(":")[1],this.entity.button.on("click",this._onClick,this)},ButtonState.prototype._onStateChange=function(t,e,s){this.entity.element.spriteAsset=e?this.defaultSprite:this.pressedSprite},ButtonState.prototype._onClick=function(){this.pressed=!this.pressed,this.target.enabled?this.target.enabled=!1:this.target.enabled=!0};pc.script.create("cards",function(t){var i=function(t){this.entity=t,this.cards=[],this.pairs=[],this.rotatingCards=[],this.rotationSpeed=220,this.clickedSets=[[]],this.totalFlips=0,this.time=1e5,this.countingTime=!1};return i.prototype={initialize:function(){},startLevel:function(){this.cards=t.root.find("name","card"),this.pairUp(),this.totalFlips=0},pairUp:function(){this.faces=this.entity.script.decks.getDeck().assets,this.cards=this.shuffle(this.cards),this.faces=this.shuffle(this.faces);for(var t=0;t<this.cards.length/2;t++)this.cards[t].findByName("Front").model.materialAsset=this.faces[t],this.cards[t+this.cards.length/2].findByName("Front").model.materialAsset=this.faces[t],this.pairs.push([t,t+this.cards.length/2])},shuffle:function(t){for(var i,s,e=t.length;0!==e;)s=Math.floor(Math.random()*e),i=t[e-=1],t[e]=t[s],t[s]=i;return t},update:function(t){this.countingTime&&(this.time+=t)},startCountingTime:function(){this.countingTime=!0,this.time=0},stopCountingTime:function(){this.countingTime=!1},flip:function(t,i,s,e){t>=0&&(i?(this.startTween(this.cards[t].getEulerAngles(),new pc.Vec3(0,0,180),this.cards[t],s,e),this.entity.audiosource.play("cardflip")):this.startTween(this.cards[t].getEulerAngles(),new pc.Vec3(0,0,0),this.cards[t],s,e))},startTween:function(t,i,s,e,c){var h=this,n=!0,r=!1;0===t.z&&(r=!0);new TWEEN.Tween({x:t.x,y:t.y,z:t.z}).to({x:i.x,y:i.y,z:i.z},750).easing(TWEEN.Easing.Back.Out).onUpdate(function(){this.z<90&&n&&!r&&(n=!1,e&&h.checkFlipped(),c&&h.clickedSets.shift()),s.setEulerAngles(this.x,this.y,this.z)}).onComplete(function(){n&&(e&&h.checkFlipped(),c&&h.clickedSets.shift())}).start()},numById:function(t){for(var i=0;i<this.cards.length;i++)if(0!==this.cards[i]&&this.cards[i].getGuid()===t)return i},notYetClicked:function(t){for(var i=0;i<this.clickedSets.length;i++)for(var s=0;s<this.clickedSets[i].length;s++)if(this.clickedSets[i][s]===t)return!1;return!0},clickCard:function(t){if(this.cards[t]&&this.notYetClicked(t)){var i=this.clickedSets[this.clickedSets.length-1];i&&1===i.length&&i[0]!==t?(this.clickedSets[this.clickedSets.length-1].push(t),this.flip(t,!0,!0)):i&&1===i.length||(i&&0===i.length?this.clickedSets[this.clickedSets.length-1].push(t):this.clickedSets.push([t]),this.flip(t,!0))}},checkFlipped:function(){this.totalFlips<1&&this.startCountingTime(),this.totalFlips++;for(var t=0;t<this.pairs.length;t++)if(this.pairs[t][0]===this.clickedSets[0][0]&&this.pairs[t][1]===this.clickedSets[0][1]||this.pairs[t][0]===this.clickedSets[0][1]&&this.pairs[t][1]===this.clickedSets[0][0])return this.matchingPair(),!0;this.clearClicked()},matchingPair:function(){(this.clickedSets[0][0]||this.clickedSets[0][1])&&(this.cards[this.clickedSets[0][0]].destroy(),this.cards[this.clickedSets[0][0]]=0,this.cards[this.clickedSets[0][1]].destroy(),this.cards[this.clickedSets[0][1]]=0,this.clickedSets.shift(),this.checkGameOver())},clearClicked:function(){this.flip(this.clickedSets[0][0],!1),this.flip(this.clickedSets[0][1],!1,!1,!0),this.entity.audiosource.play("cardflip")},checkGameOver:function(){for(var t=0;t<this.cards.length;t++)if(0!==this.cards[t])return!1;this.stopCountingTime(),this.endLevel()},endLevel:function(){var t=this.entity.script.states.getLevel(),i=this.entity.script.user.getScore(t),s=this.entity.script.user.getTime(t);(this.totalFlips<i||null===i||this.totalFlips===i&&this.time<s)&&this.entity.script.user.updateScore(t,this.totalFlips,this.time.toFixed(2)),this.cards=[],this.pairs=[],this.rotatingCards=[],this.clickedSets=[[]],this.entity.script.states.completeLevel(),this.entity.script.states.switchState(1),this.entity.audiosource.play("menuswoop"),this.totalFlips=0}},i});pc.script.create("swoosh",function(t){var e=function(t){this.entity=t,this.destroyAtTarget=!1};return e.prototype={initialize:function(){},update:function(t){TWEEN.update()},distance:function(t,e){return xd=e.x-t.x,yd=e.y-t.y,zd=e.z-t.z,Math.sqrt(xd*xd+yd*yd+zd*zd)},setTargetPos:function(t,e){e&&(this.destroyAtTarget=!0),this.startTween(this.entity.getPosition(),t)},startTween:function(t,e){var i=this;this.tween=new TWEEN.Tween({x:t.x,y:t.y,z:t.z}).to({x:e.x,y:e.y,z:e.z},1e3).easing(TWEEN.Easing.Back.Out).onUpdate(function(){i.entity.setLocalPosition(this.x,this.y,this.z),i.entity.rigidbody&&i.entity.rigidbody.syncEntityToBody()}).onComplete(function(){i.destroyAtTarget&&(TWEEN.remove(this.tween),i.entity.destroy())}).start()}},e});var AnimateCurve=pc.createScript("animateCurve");AnimateCurve.attributes.add("offsetCurve",{type:"curve",title:"Offset Curve"}),AnimateCurve.attributes.add("duration",{type:"number",default:1,title:"Duration (secs)"}),AnimateCurve.prototype.initialize=function(){this.startScale=this.entity.getLocalScale().clone(),this.scale=new pc.Vec3,this.time=0},AnimateCurve.prototype.update=function(t){this.time+=t,this.time>this.duration&&(this.time-=this.duration);var e=this.time/this.duration,i=this.offsetCurve.value(e);this.scale.copy(this.startScale),this.scale.x+=i,this.scale.y+=i,this.scale.z+=i,this.entity.setLocalScale(this.scale)};var EntityCreator=pc.createScript("entityCreator");EntityCreator.attributes.add("maxCubes",{type:"number",default:10}),EntityCreator.attributes.add("t",{type:"asset",assetType:"sprite"}),EntityCreator.attributes.add("pressedSprite",{type:"asset",assetType:"sprite",array:!0}),EntityCreator.attributes.add("cardControl",{type:"entity"}),EntityCreator.attributes.add("timerText",{type:"entity"}),EntityCreator.attributes.add("LoseScreen",{type:"entity"}),EntityCreator.attributes.add("container",{type:"entity"}),EntityCreator.attributes.add("resetItems",{type:"entity"}),EntityCreator.attributes.add("CardControl",{type:"entity"}),EntityCreator.attributes.add("fillerTile",{type:"entity"}),EntityCreator.prototype.initialize=function(){this.timer=100,this.entities=[],this.tempEntities=[],this.create()},EntityCreator.prototype.begin=function(){this.timer=100},EntityCreator.prototype.reset=function(){this.fillerTile.destroy();for(var t=this.entities.length,e=0;e<t;e++)this.entities[e].entity.destroy();this.CardControl.script.cardControl.points=this.maxCubes,this.timer=100,this.entities=[],this.tempEntities=[],this.create()},EntityCreator.prototype.create=function(){var t=this.pressedSprite;this.container.layoutgroup.enabled=!0;t.sort(function(){return.5-Math.random()}),t.length;for(var e=0,i=this.pressedSprite,r=[],n=0;n<this.maxCubes;n++)r.push({sprite:i[n]}),r.push({sprite:i[n]});for(var s=r.sort(function(){return.5-Math.random()}),a=0;a<2*this.maxCubes;a++){this.spawnCube(r[r.length-1].sprite);if(3==++e){var o=new pc.Entity;o.name="Filler",o.addComponent("element",{anchor:new pc.Vec4(.5,.5,.5,.5),pivot:new pc.Vec2(.5,.5),width:65,height:65,type:"group",rect:[0,0,1,1]}),this.container.addChild(o),o.setLocalPosition(0,0,0),o.tags.add("filler"),this.fillerTile=o}r=s.slice(0,r.length-1)}this.container.layoutgroup.enabled=!1;s.length;for(var p=0;p<this.maxCubes;p++)this.tempEntities=s.slice(0,this.tempEntities.length-1)},EntityCreator.prototype.update=function(t){this.timer-=t,this.timerText.element.text=Math.round(this.timer),this.timer<0&&(this.LoseScreen.enabled=!0,this.timer=100)},EntityCreator.prototype.spawnCube=function(t){var e=new pc.Entity;return e.name="TILE"+Math.round(pc.math.random(0,100)),e.addComponent("element",{anchor:new pc.Vec4(.5,.5,.5,.5),pivot:new pc.Vec2(.5,.5),width:140,height:140,type:"image",rect:[0,0,1,1],spriteAsset:this.t,useInput:!0}),e.addComponent("button"),e.addComponent("script"),e.script.create("cardItem",{attributes:{defaultSprite:this.t,pressedSprite:t,cardControl:this.cardControl}}),this.container.addChild(e),e.setLocalPosition(0,0,0),this.entities.push({entity:e,timer:pc.math.random(0,this.lifetime)}),this.tempEntities.push({entity:e,timer:pc.math.random(0,this.lifetime)}),e};var CardControl=pc.createScript("cardControl");CardControl.attributes.add("points",{type:"number",default:4}),CardControl.attributes.add("shouldPress",{type:"boolean",default:!0}),CardControl.attributes.add("WinScreen",{type:"entity"}),CardControl.attributes.add("EndScreen",{type:"entity"}),CardControl.prototype.initialize=function(){Date.now()},CardControl.prototype.update=function(t){this.wait&&Date.now()-this.timeStart>200&&(this.wait=!1,this.CheckCards())},CardControl.prototype.setSelected=function(t){this.Card1?(this.Card2||(this.Card2=t),this.shouldPress=!1,this.wait=!0,this.timeStart=Date.now()):this.Card1=t},CardControl.prototype.CheckCards=function(){this.Card1.script.cardItem.ID===this.Card2.script.cardItem.ID?(this.Card1.enabled=!1,this.Card2.enabled=!1,this.Card1=null,this.Card2=null,this.onCloseMenu()):(this.Card1.script.cardItem.resetCard(),this.Card2.script.cardItem.resetCard(),this.Card1=null,this.Card2=null),this.shouldPress=!0},CardControl.prototype.onCloseMenu=function(){this.points--,0===this.points&&(this.WinScreen.enabled=!0)};var CardItem=pc.createScript("cardItem");CardItem.attributes.add("defaultSprite",{type:"asset",assetType:"sprite"}),CardItem.attributes.add("pressedSprite",{type:"asset",assetType:"sprite"}),CardItem.attributes.add("dialogue",{type:"entity"}),CardItem.attributes.add("ID",{type:"string"}),CardItem.attributes.add("cardControl",{type:"entity"}),CardItem.prototype.initialize=function(){this.entity.button.on("click",this._onClick,this),this.pressed=!1,this.ID=this.pressedSprite.name},CardItem.prototype.update=function(t){},CardItem.prototype._onClick=function(){this.cardControl.script.cardControl.shouldPress&&(this.pressed?(this.entity.element.spriteAsset=this.defaultSprite,this.pressed=!1):(this.entity.element.spriteAsset=this.pressedSprite,this.pressed=!0),this.cardControl.script.cardControl.setSelected(this.entity))},CardItem.prototype.showDialogue=function(){},CardItem.prototype.resetCard=function(){this.entity.element.spriteAsset=this.defaultSprite,this.pressed=!1};var Controller=pc.createScript("controller");Controller.attributes.add("TitleScreen",{type:"entity"}),Controller.attributes.add("Instrutional",{type:"entity"}),Controller.attributes.add("Countdown",{type:"entity"}),Controller.attributes.add("Gameplay",{type:"entity"}),Controller.attributes.add("StartButton",{type:"entity"}),Controller.attributes.add("ResetA",{type:"entity"}),Controller.attributes.add("ResetB",{type:"entity"}),Controller.attributes.add("EntityCreator",{type:"entity"}),Controller.attributes.add("Win",{type:"entity"}),Controller.attributes.add("Lose",{type:"entity"}),Controller.attributes.add("End",{type:"entity"}),Controller.prototype.initialize=function(){this.StartButton.button.on("click",this._onClick,this),this.ResetA.button.on("click",this._onReset,this),this.ResetB.button.on("click",this._onReset,this)},Controller.prototype.update=function(t){},Controller.prototype._onClick=function(){this.TitleScreen.enabled=!1,this.Instrutional.enabled=!1,this.Countdown.enabled=!1,this.Gameplay.enabled=!0,this.EntityCreator.script.entityCreator.begin()},Controller.prototype._onReset=function(){this.TitleScreen.enabled=!0,this.Instrutional.enabled=!1,this.Countdown.enabled=!1,this.EntityCreator.script.entityCreator.reset(),this.Gameplay.enabled=!0,this.Win.enabled=!1,this.Lose.enabled=!1,this.End.enabled=!1};pc.script.createLoadingScreen(function(e){var t,a;t=["body {","    background-color: #FFFFFF;","}","#application-splash-wrapper {","    position: absolute;","    top: 0;","    left: 0;","    height: 100%;","    width: 100%;","    background-color: #FFFFFF;","}","#application-splash {","    position: absolute;","    top: calc(50% - 28px);","    width: 264px;","    left: calc(50% - 132px);","}","#application-splash img {","    width: 100%;","}","#progress-bar-container {","    margin: 20px auto 0 auto;","    height: 2px;","    width: 100%;","    background-color: #1d292c;","}","#progress-bar {","    width: 0%;","    height: 100%;","    background-color: #f60;","}","@media (max-width: 480px) {","    #application-splash {","        width: 170px;","        left: calc(50% - 85px);","    }","}"].join("\n"),(a=document.createElement("style")).type="text/css",a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t)),document.head.appendChild(a),function(){var e=document.createElement("div");e.id="application-splash-wrapper",document.body.appendChild(e);var t=document.createElement("div");t.id="application-splash",e.appendChild(t),t.style.display="none";var a=document.createElement("img");a.src="https://92newshd.tv/wp-content/uploads/2016/01/Philip-Morris.jpg",t.appendChild(a),a.onload=function(){t.style.display="block"};var o=document.createElement("div");o.id="progress-bar-container",t.appendChild(o);var p=document.createElement("div");p.id="progress-bar",o.appendChild(p)}(),e.on("preload:end",function(){e.off("preload:progress")}),e.on("preload:progress",function(e){var t=document.getElementById("progress-bar");t&&(e=Math.min(1,Math.max(0,e)),t.style.width=100*e+"%")}),e.on("start",function(){var e=document.getElementById("application-splash-wrapper");e.parentElement.removeChild(e)})});